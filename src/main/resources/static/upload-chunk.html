<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <input type="file" id="chunk" />
    <input type="text" id="userId" name="userId"/>
    <button onclick="Upload()">Submit</button>

    <script>
        async function Upload(){
            const file = document.getElementById("chunk").files[0];
            const id = document.getElementById("userId").value;
            const chunk_size = 5*1024*1024;
            let start = 0;

            if(file != null && id != null)
            {
                while(start < file.size){
                    const chunk = file.slice(start, start+chunk_size);
                    const formData = new FormData();
                    formData.append("chunk",chunk);
                    formData.append("filename", file.name);
                    formData.append("userId", id);
                    const response = await fetch("/file", {
                        method: "POST",
                        body: formData
                    });
                    if(response.status != 200){
                        alert("failed");
                        break;
                    }
                    start += chunk_size;
                }
            } else {
                alert("fill all entries");
                return;
            }
            const r = await fetch(`/uploaded/${file.name}`);
            console.log(r);
            const d = await r.text();
            console.log(d);
        }
    </script>
</body>
</html>